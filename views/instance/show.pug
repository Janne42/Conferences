extends ../layout

block content
    h2
        a(href=c_path)
            | #{conf.name}
        | &nbsp;#{instance.year}

    h3 Basic information
    table(class='table table-sm')
        tbody
            tr
                th(scope='row') URL
                td
                    a(href=instance.url) #{instance.url}

    if (user)
        div(class="input-group mb-3")
            if perms.can_edit
                a(href=ci_path + '/edit')
                    button(class='btn btn-sm btn-info', type='submit') Edit

            if perms.can_delete
                form(method='POST', action=ci_path + '?_method=DELETE')
                    button(class='btn btn-sm btn-danger', type='submit') Delete

    h3 Call For Papers
    table(class='table table-sm')
        tbody
            if (user)
                tr
                    td(scope='row')
                        form(method='POST', action=ci_path + '/track')
                            div(class='input-group input-group-sm')
                                label(class="input-group-text", for='instance_name') Name:
                                input#instance_name(type='text', name='name')
                                button(class='btn btn-sm', type='submit') New
            each val in tracks
                tr
                    td
                        a(href=ci_path + '/track/' + val.id) #{val.name}

    h3 Dates
    table(class='table table-sm')
        thead
            tr
                th(scope='col') When
                th(scope='col') What
                th(scope='col') &nbsp;
        tbody
            if (user)
                tr
                    form(method='POST', action='/date')
                        input(type='hidden', name='conf_id', value=conf.id)
                        input(type='hidden', name='instance_id', value=instance.id)
                        td(scope='row')
                            input#date_when(type='date', name='datevalue')
                        td
                            input#date_what(type='text', name='what')
                        td
                            button(class='btn btn-sm', type='submit') New

            if (instance.submission)
                tr
                    td #{instance.submission}
                    td Submission
                    td &nbsp;
            if (instance.notification)
                tr
                    td #{instance.notification}
                    td Notification
                    td &nbsp;
            if (instance.camera_ready)
                tr
                    td #{instance.camera_ready}
                    td Camera ready
                    td &nbsp;
            if (instance.conf_start)
                tr
                    td #{instance.conf_start}
                    td Conference start
                    td &nbsp;
            if (instance.conf_end)
                tr
                    td #{instance.conf_end}
                    td Conference end
                    td &nbsp;

        each val in instance.dates
                tr
                    td #{val.datevalue}
                    td #{val.what}
                    td
                        if (user)
                            form(method='POST', action='/date/' + val.id + '?_method=DELETE')
                                span(class="input-group")
                                    input(type='hidden', name='conf_id', value=conf.id)
                                    input(type='hidden', name='instance_id', value=instance.id)
                                    button(class='btn btn-sm btn-danger', type='submit') Delete
